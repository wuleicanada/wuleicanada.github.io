<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[My Octopress Blog]]></title>
  <link href="http://wuleicanada.github.io/atom.xml" rel="self"/>
  <link href="http://wuleicanada.github.io/"/>
  <updated>2014-08-18T19:40:45+00:00</updated>
  <id>http://wuleicanada.github.io/</id>
  <author>
    <name><![CDATA[Lei Wu]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Sinatra, JBoss6, JDBC and ActiveRecord]]></title>
    <link href="http://wuleicanada.github.io/blog/2014/08/18/sinatra-jboss-jdbc-activerecord/"/>
    <updated>2014-08-18T17:58:16+00:00</updated>
    <id>http://wuleicanada.github.io/blog/2014/08/18/sinatra-jboss-jdbc-activerecord</id>
    <content type="html"><![CDATA[<p>The article describes how to create a JRuby Sinatra web application and deploy it on JBoss6. I use JDBC and ActiveRecord to interact with a SQL Server database.</p>

<h2>Set up dev environment on Windows 7</h2>

<h3>Install JRuby</h3>

<p>For Windows 7, just download and install the <code>exe(x64)</code> executable.</p>

<h3>Install necessary gems</h3>

<p>First, create the Gemfile with the following content:</p>

<pre><code class="ruby">source "http://rubygems.org"

gem "sinatra"
gem "activerecord"
gem "sinatra-activerecord"
gem 'activerecord-jdbc-adapter'
gem 'sinatra-formhelpers-ng'


group :development do
  gem "tux"
end
</code></pre>

<p>And run <code>jruby --command bundle install</code> to install the gems.</p>

<p>Note: The <code>tux</code> gem works as a console to interact with my Sinatra application. I would also love to have the <code>shotgun</code> gem, but unfortuantely it&rsquo;s unavaible for JRuby.</p>

<p>The JDBC driver (<code>sqljdbc4.jar</code>) for SQL Server can be downloaded from Microsoft&rsquo;s web site.</p>

<h2>Deploy to JBoss</h2>

<h3>Create WAR file using Warbler</h3>

<p>First step is to install Warbler as a gem <code>jruby --command gem install warbler</code>. Next, we need to configure Warbler:
* Create a new folder called <code>config</code> under our application root
* Run <code>jruby --command warble config</code>, which generates a configuration template called <code>warble.rb</code> under the <code>config</code> folder
* Edit <code>config\warble.rb</code> and update these lines:
&#8220;`ruby
    # Application directories to be included in the webapp.
    config.dirs = %w(views)</p>

<pre><code># Additional files/directories to include, above those in config.dirs
config.includes = FileList['app.rb', 'sqljdbc4.jar']

# Uncomment this if you don't want to package rails gem.
config.gems -= ["rails"]
</code></pre>

<p>&#8220;`</p>
]]></content>
  </entry>
  
</feed>
